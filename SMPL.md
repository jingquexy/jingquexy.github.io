# **SMPL 模型**

> - [SMPL: A Skinned Multi-Person Linear Model](https://dl.acm.org/doi/pdf/10.1145/2816795.2818013)，([Loper 等, 2015](zotero://select/library/items/BSEMBJ4W))
>     
>     - 我们提出了一种人体形状和与姿势相关的形状变化的学习模型，它比以前的模型更准确，而且与现有的图形处理流水线兼容。我们的蒙皮多人形线性模型（SMPL）是一种基于蒙皮顶点的模型，能准确表现自然人体姿势中的各种体形。该模型的参数是通过数据学习获得的，其中包括其余姿势模板、混合权重、与姿势相关的混合形状、与身份相关的混合形状以及从顶点到关节位置的回归器。与以往的模型不同，与姿势相关的混合形状是姿势旋转矩阵元素的线性函数。通过这种简单的表述方式，可以从相对较多的不同人物不同姿势的对齐三维网格中训练整个模型。我们对使用线性或双四元混合蒙皮的 SMPL 变体进行了定量评估，结果表明两者都比在相同数据上训练的 BlendSCAPE 模型更精确。我们还对 SMPL 进行了扩展，以逼真地模拟动态软组织变形。由于 SMPL 基于混合蒙皮技术，因此与现有的渲染引擎兼容，我们将其用于研究目的。

**SMPL 模型**（“带皮多人线性模型”）是一种用于数字化表示人体的三维参数化模型。在步态识别和计算机视觉领域，它的核心特点如下：

1. ### **更完整的 3D 表征**
    
    SMPL 模型是一种 3D 人体网格（3D Mesh）。与传统的 2D 轮廓（Silhouette）或稀疏的骨骼关键点（Keypoints）相比，它提供了一种更稠密、更完整的表征形式。
    
2. ### **核心信息涵盖**
    
    SMPL 模型能够从视频中恢复并捕捉以下关键信息：
    
    - **体型（Shape）**：反映个体的胖瘦高矮等身体形态特征。
    - **视角（View）**：提供三维空间中的视角信息，有助于解决跨视角识别难题。
    - **动态（Dynamics）：**包含人体的运动姿态变化。
        
        它被认为是一种极其完善的表征，因为它隐式地同时结合了运动学信息（骨架）和理想化的体型外观信息。
        
3. ### **在步态识别中的应用**
    
    - **解决 2D 局限性**：由于人类是在无约束的三维空间中行走的，将三维人体投影到二维平面会丢失很多关键信息。SMPL 模型旨在解决这一问题，在“野外”（in-the-wild）场景中提供更鲁棒的特征。
    - **数据集支持**：大规模步态数据集 **Gait3D** 的核心贡献之一就是提供了从视频帧中恢复的 3D SMPL 模型数据，用于训练能够感知三维几何信息的识别网络（如 SMPLGait）。

（Skinned Multi-Person Linear Model，线性蒙皮多人模型）是一种目前在计算机视觉和图形学中广泛使用的**参数化 3D 人体模型**。

它的核心原理是通过少量的参数（形状和姿态）来精确地重建和控制逼真的 3D 人体网格。简单来说，它是一个数学公式，输入“高矮胖瘦”和“动作姿态”，输出一个包含数千个顶点的完整 3D 人体模型。

以下是对 SMPL 模型原理的系统梳理：

## 1\. 核心设计理念：参数化与解耦

SMPL 模型最大的特点是将人体的**形状（Shape）和姿态（Pose）**进行了分离（解耦），分别用两组低维参数来控制。

- **形状参数 (β, Shape Parameters)**：通常是一个长度为 10 或更多的向量。它通过主成分分析（PCA）从成千上万个激光扫描的真实人体数据中学习得到。改变β可以让人体变高、变矮、变胖、变瘦，或者改变身体比例。
- **姿态参数 ( θ, Pose Parameters)**：通常包含 24×3个参数（对应 23 个关节点 + 1 个根节点的 3D 旋转，通常使用轴角表示）。改变 θ 可以让人体做出各种动作（如走路、挥手），对应人体骨骼的运动。

## 2\. 模型构建过程（从参数到网格）

SMPL 生成人体网格的过程是一个**线性叠加**加上**蒙皮变形**的过程，这也是它被称为“线性（Linear）”模型的原因。整个过程可以分为以下几个步骤：

### **第一步：基础模板与形状变形 (Shape Blend Shapes)**

模型从一个平均的“标准人体模板”（Template Mesh, $ \bar{T}$）开始（通常是 T-pose）。

- 根据输入的**形状参数** $\beta$ ，计算出形状偏移量 $B_s(β)$ 。
- 将偏移量加到模板上，得到一个“个性化”但仍处于静止 T-pose 的人体。例如，如果 $\beta$ 指示“肥胖”，这一步会将腹部的顶点向外推。

### **第二步：姿态相关的形状修正 (Pose Blend Shapes)**

这是 SMPL 的关键创新点。传统的骨骼绑定在关节弯曲时容易产生“糖纸效应”（关节处体积塌陷或扭曲）。

- SMPL 引入了**姿态混合形状 $B_p(\theta)$**。它根据**姿态参数** $\theta$，计算出额外的顶点偏移量。
- **原理**：模拟肌肉和软组织的变形。例如，当手臂弯曲时，二头肌应该隆起。SMPL 通过预先学习好的线性关系，在弯曲关节前自动把该处的网格“隆起”一点，这样弯曲后看起来就非常自然。

### **第三步：关节位置回归 (Joint Regression)**

由于人体的体型（$\beta$ ）变了（比如腿变长了），骨骼关节的位置也必须跟着变。

- SMPL 使用一个回归矩阵 $J(\beta)$，直接根据当前的体型网格，计算出与之匹配的体内关节的三维坐标。

### **第四步：线性蒙皮 (Linear Blend Skinning, LBS)**

最后，利用标准的线性蒙皮技术，根据计算出的关节位置和输入的姿态旋转矩阵，将网格上的每个点“带”到正确的位置。

- 公式化描述：
    
    $$M(\beta, \theta) = W(T_P(\beta, \theta), J(\beta), \theta, \mathcal{W})$$
    
    其中 $T_P$ 是经过形状和姿态修正后的静止网格，$W$ 是蒙皮函数，$\mathcal{W}$ 是蒙皮权重。
    

## 3\. 为什么叫 "Linear"（线性）？

尽管人体变形是非线性的，但 SMPL 将其分解为一系列**线性变换**的组合：

- 形状变形是形状系数的线性组合。
- 姿态修正是姿态旋转矩阵元素的线性组合。
    
    这种设计使得模型在计算上非常高效，且完全可微（Differentiable），非常适合深度学习网络直接预测参数进行训练（如 HMR, SPIN, PARE 等算法）。
    

## 4\. 在步态识别中的作用

结合您之前的文件，SMPL 在开放场景步态识别（如 Gait3D, GREW）中的价值在于：

- **稠密信息**：它不只是稀疏的骨架点，而是提供了 6890 个顶点的完整表面信息。
- **去伪存真**：它可以从 RGB 视频中恢复出剥离了衣物、光照干扰的“纯净”人体 3D 形状和运动轨迹，为鲁棒性分析提供了物理一致的特征。